<!-- accounts/templates/accounts/user_list.html -->
{% extends 'base.html' %}
{% load static %}

{% block title %}Ù„ÛŒØ³Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'accounts/accounts/css/user_list.css' %}">
{% endblock %}

{% block content %}
<div class="user-list-page">
    <div class="container mt-4">
        <!-- Ù‡Ø¯Ø± ØµÙØ­Ù‡ -->
        <div class="user-list-header">
            <div class="d-flex justify-content-between align-items-center">
                <h1 class="user-list-title">ğŸ‘¥ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</h1>
                <a href="{% url 'accounts:admin_dashboard' %}" class="btn btn-outline-primary">
                    <i class="fas fa-arrow-right me-1"></i>Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯
                </a>
            </div>
        </div>

        <!-- Ú©Ø§Ø±Øª Ù„ÛŒØ³Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù† -->
        <div class="user-list-container">
            <div class="user-list-header-inner">
                <h3 class="user-list-section-title">
                    <i class="fas fa-users me-2"></i>Ù‡Ù…Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø³ÛŒØ³ØªÙ…
                </h3>
                <span class="user-count-badge">{{ users.count }} Ú©Ø§Ø±Ø¨Ø±</span>
            </div>

            {% if messages %}
            <div class="mb-4">
                {% for message in messages %}
                <div class="alert {% if message.tags == 'success' %}alert-success{% else %}alert-danger{% endif %}">
                    <i class="fas {% if message.tags == 'success' %}fa-check-circle{% else %}fa-exclamation-triangle{% endif %} me-2"></i>
                    {{ message }}
                </div>
                {% endfor %}
            </div>
            {% endif %}

            <div class="users-table">
                <div class="table-responsive">
                    <table class="table table-dark table-hover">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ</th>
                                <th>Ø§ÛŒÙ…ÛŒÙ„</th>
                                <th>Ù†Ø§Ù… Ú©Ø§Ù…Ù„</th>
                                <th>ØªØ§Ø±ÛŒØ® Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</th>
                                <th>ÙˆØ¶Ø¹ÛŒØª</th>
                                <th>Ù†Ù‚Ø´</th>
                                <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for user in users %}
                            <tr>
                                <td data-label="Ø±Ø¯ÛŒÙ">{{ forloop.counter }}</td>
                                <td data-label="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ">
                                    <div class="user-username">
                                        <div class="user-avatar-small">
                                            {{ user.username|first|upper }}
                                        </div>
                                        <strong>{{ user.username }}</strong>
                                    </div>
                                </td>
                                <td data-label="Ø§ÛŒÙ…ÛŒÙ„">{{ user.email|default:"-" }}</td>
                                <td data-label="Ù†Ø§Ù… Ú©Ø§Ù…Ù„">
                                    {% if user.first_name or user.last_name %}
                                        {{ user.first_name }} {{ user.last_name }}
                                    {% else %}
                                        <span class="text-muted">ØªØ¹ÛŒÛŒÙ† Ù†Ø´Ø¯Ù‡</span>
                                    {% endif %}
                                </td>
                                <td data-label="ØªØ§Ø±ÛŒØ® Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…">{{ user.date_joined|date:"Y/m/d" }}</td>
                                <td data-label="ÙˆØ¶Ø¹ÛŒØª">
                                    {% if user.is_active %}
                                        <span class="status-badge">ÙØ¹Ø§Ù„</span>
                                    {% else %}
                                        <span class="badge bg-secondary">ØºÛŒØ±ÙØ¹Ø§Ù„</span>
                                    {% endif %}
                                </td>
                                <td data-label="Ù†Ù‚Ø´">
                                    {% if user.is_superuser %}
                                        <span class="role-badge role-superuser">Ø³ÙˆÙ¾Ø± Ú©Ø§Ø±Ø¨Ø±</span>
                                    {% elif user.is_staff %}
                                        <span class="role-badge role-staff">Ù…Ø¯ÛŒØ±</span>
                                    {% else %}
                                        <span class="role-badge role-user">Ú©Ø§Ø±Ø¨Ø± Ø¹Ø§Ø¯ÛŒ</span>
                                    {% endif %}
                                </td>
                                <td data-label="Ø¹Ù…Ù„ÛŒØ§Øª">
                                    <div class="action-buttons">
                                        <a href="{% url 'accounts:user_detail' user.id %}" 
                                           class="btn-action btn-view" title="Ù…Ø´Ø§Ù‡Ø¯Ù‡">
                                            <i class="fas fa-eye"></i>
                                        </a>
                                        {% if user.id != request.user.id %}
                                        <a href="{% url 'accounts:toggle_user_active' user.id %}" 
                                           class="btn-action {% if user.is_active %}btn-deactivate{% else %}btn-toggle{% endif %}"
                                           title="{% if user.is_active %}ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù†{% else %}ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù†{% endif %}">
                                            <i class="fas {% if user.is_active %}fa-ban{% else %}fa-check{% endif %}"></i>
                                        </a>
                                        {% endif %}
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="8">
                                    <div class="empty-users-state">
                                        <i class="fas fa-users"></i>
                                        <h4>Ù‡ÛŒÚ† Ú©Ø§Ø±Ø¨Ø±ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</h4>
                                        <p class="text-muted">Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ù‡ÛŒÚ† Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¯Ø± Ø³ÛŒØ³ØªÙ… Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù†Ú©Ø±Ø¯Ù‡ Ø§Ø³Øª</p>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}